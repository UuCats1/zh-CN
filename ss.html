/**

     *

     * 微信授权

     */

    public static function wechat_login($appid, $appsecret, $code)

    {

        $token_url = 'https://api.weixin.qq.com/sns/oauth2/access_token?appid=' . $appid . '&secret=' . $appsecret . '&code=' . $code . '&grant_type=authorization_code';

        $token = json_decode(file_get_contents($token_url));

        //var_dump($token);die;

        if (isset($token->errcode)) {

            return false;

        }

        $access_token_url = 'https://api.weixin.qq.com/sns/oauth2/refresh_token?appid=' . $appid . '&grant_type=refresh_token&refresh_token=' . $token->refresh_token;

        //转成对象

        $access_token = json_decode(file_get_contents($access_token_url));

        if (isset($access_token->errcode)) {

            return false;

        }

        $user_info_url = 'https://api.weixin.qq.com/sns/userinfo?access_token=' . $access_token->access_token . '&openid=' . $access_token->openid . '&lang=zh_CN';

        //转成对象

        $user_info = json_decode(file_get_contents($user_info_url));

        if (isset($user_info->errcode)) {

            return false;

        }

        //var_dump($user_info);die;

        $result = json_decode(json_encode($user_info), true);//返回的json数组转换成array数组

        //var_dump($result);die;

        return $result;

    }
